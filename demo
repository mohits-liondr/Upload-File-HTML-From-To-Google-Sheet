<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
</head>
<body>
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-5 col-md-8 mx-auto shadow border bg-white p-4 rounded">
                <nav class="navbar navbar-dark bg-primary">
                    <a class="navbar-brand" href="#" fw-bold mb-3>Form Upload File</a>
                </nav>
                <br>
                <form id="myForm" onsubmit="handleFormSubmit(event)">
                    <div id="form_alerts"></div>
                    
                    <!-- Date -->
                    <div class="form-group mb-3">
                        <label for="date" class="form-label">Date</label>
                        <input type="date" id="date" name="date" class="form-control" required>
                    </div>

                    <!-- Employee Code -->
                    <div class="form-group mb-3">
                        <label for="employee_code" class="form-label">Employee Code</label>
                        <input type="text" id="employee_code" name="employee_code" class="form-control" required>
                    </div>

                    <!-- Name -->
                    <div class="form-group mb-3">
                        <label for="name" class="form-label">Name</label>
                        <input type="text" id="name" name="name" class="form-control" required>
                    </div>

                    <!-- Designation -->
                    <div class="form-group mb-3">
                        <label for="designation" class="form-label">Designation</label>
                        <select id="designation" name="designation" class="form-control" required>
                            <option value="">Select Designation</option>
                            <option value="designation1">Designation 1</option>
                            <option value="designation2">Designation 2</option>
                        </select>
                    </div>

                    <!-- HQ Name -->
                    <div class="form-group mb-3">
                        <label for="hq_name" class="form-label">HQ Name</label>
                        <input type="text" id="hq_name" name="hq_name" class="form-control" required>
                    </div>

                    <!-- Working Status -->
                    <div class="form-group mb-3">
                        <label for="working_status" class="form-label">Working Status</label>
                        <select id="working_status" name="working_status" class="form-control" required>
                            <option value="">Select Working Status</option>
                            <option value="working">Working</option>
                            <option value="not_working">Not Working</option>
                        </select>
                    </div>

                    <!-- Worked With -->
                    <div class="form-group mb-3">
                        <label class="form-label">Worked With</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="asm" name="worked_with[]" value="ASM">
                            <label class="form-check-label" for="asm">ASM</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="dsm" name="worked_with[]" value="DSM">
                            <label class="form-check-label" for="dsm">DSM</label>
                        </div>
                    </div>

                    <!-- Immediate Reporting Manager -->
                    <div class="form-group mb-3">
                        <label for="immediate_reporting_manager" class="form-label">Immediate Reporting Manager</label>
                        <input type="text" id="immediate_reporting_manager" name="immediate_reporting_manager" class="form-control" required>
                    </div>

                    <!-- Reporting Manager Mail ID -->
                    <div class="form-group mb-3">
                        <label for="reporting_manager_mail" class="form-label">Reporting Manager Mail ID</label>
                        <input type="email" id="reporting_manager_mail" name="reporting_manager_mail" class="form-control" required>
                    </div>

                    <!-- Route -->
                    <div class="form-group mb-3">
                        <label for="route" class="form-label">Route</label>
                        <input type="text" id="route" name="route" class="form-control" required>
                    </div>

                    <!-- Locality -->
                    <div class="form-group mb-3">
                        <label for="locality" class="form-label">Locality</label>
                        <select id="locality" name="locality" class="form-control" required>
                            <option value="">Select Locality</option>
                            <option value="locality1">Locality 1</option>
                            <option value="locality2">Locality 2</option>
                        </select>
                    </div>

                    <!-- KM -->
                    <div class="form-group mb-3">
                        <label for="km" class="form-label">KM</label>
                        <input type="number" id="km" name="km" class="form-control" required>
                    </div>

                    <!-- Mode of Travel -->
                    <div class="form-group mb-3">
                        <label for="mode_of_travel" class="form-label">Mode of Travel</label>
                        <select id="mode_of_travel" name="mode_of_travel" class="form-control" required>
                            <option value="">Select Mode of Travel</option>
                            <option value="bus">Bus</option>
                            <option value="train">Train</option>
                            <option value="flight">Flight</option>
                        </select>
                    </div>

                    <!-- Fare -->
                    <div class="form-group mb-3">
                        <label for="fare" class="form-label">Fare</label>
                        <input type="number" id="fare" name="fare" class="form-control" required>
                    </div>

                    <!-- Fare Bill Attachment -->
                    <div class="form-group mb-3">
                        <label for="fare_bill_attachment" class="form-label">Fare Bill Attachment</label>
                        <input type="file" id="fare_bill_attachment" name="fare_bill_attachment" class="form-control" required>
                    </div>

                    <!-- Additional Expense -->
                    <div class="form-group mb-3">
                        <label for="additional_expense" class="form-label">Any Additional Expense</label>
                        <input type="number" id="additional_expense" name="additional_expense" class="form-control">
                    </div>

                    <!-- Additional Expense Attachment -->
                    <div class="form-group mb-3">
                        <label for="additional_expense_attachment" class="form-label">Additional Expense Attachment</label>
                        <input type="file" id="additional_expense_attachment" name="additional_expense_attachment" class="form-control">
                    </div>

                    <!-- Courier -->
                    <div class="form-group mb-3">
                        <label for="courier" class="form-label">Courier</label>
                        <input type="number" id="courier" name="courier" class="form-control">
                    </div>

                    <!-- Courier Bill Attachment -->
                    <div class="form-group mb-3">
                        <label for="courier_bill_attachment" class="form-label">Courier Bill Attachment</label>
                        <input type="file" id="courier_bill_attachment" name="courier_bill_attachment" class="form-control">
                    </div>

                    <!-- Remarks for Additional Expense and Courier -->
                    <div class="form-group mb-3">
                        <label for="remarks" class="form-label">Remarks for Additional Expense and Courier</label>
                        <textarea id="remarks" name="remarks" class="form-control"></textarea>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="btn btn-primary btn-block">Submit Data</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        function preventFormSubmit() {
            var forms = document.querySelectorAll('form');
            for (var i = 0; i < forms.length; i++) {
                forms[i].addEventListener('submit', function (event) {
                    event.preventDefault();
                });
            }
        }

        window.addEventListener('load', preventFormSubmit);

        function handleFormSubmit(event) {
            event.preventDefault();
            var formdata = new FormData(document.getElementById("myForm"));
            var fileData = {};
            ['fare_bill_attachment', 'additional_expense_attachment', 'courier_bill_attachment'].forEach(function (id) {
                var fileInput = document.getElementById(id);
                if (fileInput.files.length > 0) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        fileData[id] = { name: fileInput.files[0].name, data: e.target.result };
                        if (Object.keys(fileData).length === 3) {
                            sendData(formdata, fileData);
                        }
                    };
                    reader.readAsDataURL(fileInput.files[0]);
                } else {
                    fileData[id] = null;
                }
            });
        }

        function sendData(formdata, fileData) {
            formdata.append('fare_bill_attachment', JSON.stringify(fileData.fare_bill_attachment));
            formdata.append('additional_expense_attachment', JSON.stringify(fileData.additional_expense_attachment));
            formdata.append('courier_bill_attachment', JSON.stringify(fileData.courier_bill_attachment));
            google.script.run.withSuccessHandler(success).processForm(formdata);
        }

        function success() {
            document.getElementById("myForm").reset();
            Swal.fire({
                position: 'center',
                icon: 'success',
                title: 'Your data has been submitted!',
                showConfirmButton: false,
                timer: 1500
            });
        }
    </script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>
